{"ast":null,"code":"var _jsxFileName = \"/Users/devanshgoenka/Desktop/seva/frontend/src/components/DashboardUser.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport ReportForm from \"./ReportForm\";\nimport ReportList from \"./ReportList\";\nimport ReportView from \"./ReportView\";\nimport MapView from \"./MapView\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function DashboardUser({\n  user\n}) {\n  _s();\n  const [reports, setReports] = useState([]);\n  const [viewReport, setViewReport] = useState(null);\n\n  // load from localStorage for demo\n  useEffect(() => {\n    const raw = localStorage.getItem(\"seva_reports\") || \"[]\";\n    setReports(JSON.parse(raw));\n  }, []);\n  function saveReports(arr) {\n    localStorage.setItem(\"seva_reports\", JSON.stringify(arr));\n    setReports(arr);\n  }\n  function handleNewReport(r) {\n    // auto assign authority simple: use category -> find matching authority from localStorage\n    const authRaw = localStorage.getItem(\"seva_authorities\") || \"[]\";\n    const authorities = JSON.parse(authRaw);\n    // naive mapping:\n    let matched = authorities.find(a => {\n      var _a$department;\n      return (_a$department = a.department) === null || _a$department === void 0 ? void 0 : _a$department.toLowerCase().includes(r.category);\n    }) || null;\n    if (!matched) {\n      // fallback: first sanitation or PWD or police\n      matched = authorities.find(a => {\n        var _a$id;\n        return (_a$id = a.id) === null || _a$id === void 0 ? void 0 : _a$id.includes(\"sanitation\");\n      }) || authorities[0] || null;\n    }\n    r.assignedTo = matched ? matched.id : null;\n    const arr = [r, ...reports];\n    saveReports(arr);\n    alert(\"Report submitted\");\n  }\n  function handleView(r) {\n    setViewReport(r);\n  }\n  function closeView() {\n    setViewReport(null);\n  }\n  function handleVote(id) {\n    const arr = reports.map(r => r.id === id ? {\n      ...r,\n      votes: (r.votes || 0) + 1\n    } : r);\n    saveReports(arr);\n  }\n  function handleCompleteVote(id) {\n    const arr = reports.map(r => r.id === id ? {\n      ...r,\n      completedVotes: (r.completedVotes || 0) + 1\n    } : r);\n    saveReports(arr);\n  }\n  function handleComment(id, comment) {\n    const arr = reports.map(r => r.id === id ? {\n      ...r,\n      comments: [...(r.comments || []), comment]\n    } : r);\n    saveReports(arr);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"User Dashboard\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"grid-2\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(ReportForm, {\n          onSave: handleNewReport\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 58,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ReportList, {\n          reports: reports,\n          onView: handleView,\n          onVote: handleVote,\n          onCompleteVote: handleCompleteVote\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 59,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"Map \\u2014 Live reports in Bettiah\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(MapView, {\n          markers: reports.filter(r => r.lat && r.lng).map(r => ({\n            id: r.id,\n            lat: parseFloat(r.lat),\n            lng: parseFloat(r.lng),\n            title: r.title,\n            popup: r.area\n          })),\n          height: \"600px\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 7\n    }, this), viewReport && /*#__PURE__*/_jsxDEV(ReportView, {\n      report: viewReport,\n      onClose: closeView,\n      onComment: handleComment,\n      user: user\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 22\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 54,\n    columnNumber: 5\n  }, this);\n}\n_s(DashboardUser, \"lpcCwEcaf52FwFzVDV757hHS1tk=\");\n_c = DashboardUser;\nvar _c;\n$RefreshReg$(_c, \"DashboardUser\");","map":{"version":3,"names":["React","useEffect","useState","ReportForm","ReportList","ReportView","MapView","jsxDEV","_jsxDEV","DashboardUser","user","_s","reports","setReports","viewReport","setViewReport","raw","localStorage","getItem","JSON","parse","saveReports","arr","setItem","stringify","handleNewReport","r","authRaw","authorities","matched","find","a","_a$department","department","toLowerCase","includes","category","_a$id","id","assignedTo","alert","handleView","closeView","handleVote","map","votes","handleCompleteVote","completedVotes","handleComment","comment","comments","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onSave","onView","onVote","onCompleteVote","markers","filter","lat","lng","parseFloat","title","popup","area","height","report","onClose","onComment","_c","$RefreshReg$"],"sources":["/Users/devanshgoenka/Desktop/seva/frontend/src/components/DashboardUser.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport ReportForm from \"./ReportForm\";\nimport ReportList from \"./ReportList\";\nimport ReportView from \"./ReportView\";\nimport MapView from \"./MapView\";\n\nexport default function DashboardUser({ user }){\n  const [reports, setReports] = useState([]);\n  const [viewReport, setViewReport] = useState(null);\n\n  // load from localStorage for demo\n  useEffect(()=> {\n    const raw = localStorage.getItem(\"seva_reports\") || \"[]\";\n    setReports(JSON.parse(raw));\n  }, []);\n\n  function saveReports(arr){\n    localStorage.setItem(\"seva_reports\", JSON.stringify(arr));\n    setReports(arr);\n  }\n\n  function handleNewReport(r){\n    // auto assign authority simple: use category -> find matching authority from localStorage\n    const authRaw = localStorage.getItem(\"seva_authorities\") || \"[]\";\n    const authorities = JSON.parse(authRaw);\n    // naive mapping:\n    let matched = authorities.find(a => a.department?.toLowerCase().includes(r.category)) || null;\n    if(!matched){\n      // fallback: first sanitation or PWD or police\n      matched = authorities.find(a => a.id?.includes(\"sanitation\")) || authorities[0] || null;\n    }\n    r.assignedTo = matched ? matched.id : null;\n    const arr = [r, ...reports];\n    saveReports(arr);\n    alert(\"Report submitted\");\n  }\n\n  function handleView(r){ setViewReport(r); }\n  function closeView(){ setViewReport(null); }\n  function handleVote(id){\n    const arr = reports.map(r => r.id === id ? {...r, votes: (r.votes||0)+1 } : r);\n    saveReports(arr);\n  }\n  function handleCompleteVote(id){\n    const arr = reports.map(r => r.id === id ? {...r, completedVotes: (r.completedVotes||0)+1 } : r);\n    saveReports(arr);\n  }\n  function handleComment(id, comment){\n    const arr = reports.map(r => r.id === id ? {...r, comments: [...(r.comments||[]), comment]} : r);\n    saveReports(arr);\n  }\n\n  return (\n    <div className=\"container\">\n      <h2>User Dashboard</h2>\n      <div className=\"grid-2\">\n        <div>\n          <ReportForm onSave={handleNewReport} />\n          <ReportList reports={reports} onView={handleView} onVote={handleVote} onCompleteVote={handleCompleteVote} />\n        </div>\n        <div>\n          <h3>Map â€” Live reports in Bettiah</h3>\n          <MapView markers={reports.filter(r=>r.lat && r.lng).map(r=>({id:r.id, lat:parseFloat(r.lat), lng:parseFloat(r.lng), title:r.title, popup:r.area}))} height=\"600px\" />\n        </div>\n      </div>\n\n      {viewReport && <ReportView report={viewReport} onClose={closeView} onComment={handleComment} user={user} />}\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}