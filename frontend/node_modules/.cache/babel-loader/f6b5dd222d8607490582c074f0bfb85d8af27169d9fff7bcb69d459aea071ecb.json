{"ast":null,"code":"var _jsxFileName = \"/Users/devanshgoenka/Desktop/seva/frontend/src/components/ReportView.jsx\",\n  _s = $RefreshSig$();\n// src/components/ReportView.jsx\nimport React, { useEffect, useState, useRef } from \"react\";\nimport MapView from \"./MapView\";\nimport api from \"../api/api\";\nimport { jsPDF } from \"jspdf\";\nimport html2canvas from \"html2canvas\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction VerifiedBadge({\n  text\n}) {\n  return /*#__PURE__*/_jsxDEV(\"span\", {\n    style: {\n      display: \"inline-flex\",\n      alignItems: \"center\",\n      gap: 6,\n      background: \"#e6ffed\",\n      color: \"#0b7a3a\",\n      padding: \"2px 8px\",\n      borderRadius: 12,\n      fontSize: 12,\n      marginLeft: 8\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n      children: \"\\u2713\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 23,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n      style: {\n        fontWeight: 600\n      },\n      children: text || \"Verified\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 24,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 10,\n    columnNumber: 5\n  }, this);\n}\n_c = VerifiedBadge;\nexport default function ReportView({\n  report,\n  onClose,\n  onComment,\n  user\n}) {\n  _s();\n  var _report$comments;\n  const [commentText, setCommentText] = useState(\"\");\n  const [route, setRoute] = useState(null);\n  const [etaInfo, setEtaInfo] = useState(null);\n  const [loadingRoute, setLoadingRoute] = useState(false);\n  const [assignedName, setAssignedName] = useState(report.assignedTo || null);\n\n  // ðŸ”½ NEW: ref for PDF capture\n  const pdfRef = useRef(null);\n  useEffect(() => {\n    async function fetchAssigned() {\n      if (!report.assignedTo) return;\n      if (process.env.REACT_APP_API_BASE) {\n        try {\n          const a = await api.getAuthorityById(report.assignedTo);\n          if (a && a.name) setAssignedName(a.name);\n          return;\n        } catch (e) {}\n      }\n      const auths = JSON.parse(localStorage.getItem(\"seva_authorities\") || \"[]\");\n      const found = auths.find(x => x.id === report.assignedTo);\n      if (found) setAssignedName(found.name);\n    }\n    fetchAssigned();\n  }, [report.assignedTo]);\n  async function calcETA() {\n    if (!report.lat || !report.lng) {\n      alert(\"Report has no coordinates\");\n      return;\n    }\n    if (!navigator.geolocation) {\n      alert(\"Geolocation not available\");\n      return;\n    }\n    navigator.geolocation.getCurrentPosition(async pos => {\n      setLoadingRoute(true);\n      const start = [pos.coords.longitude, pos.coords.latitude];\n      const end = [parseFloat(report.lng), parseFloat(report.lat)];\n      if (process.env.REACT_APP_API_BASE) {\n        try {\n          var _feat$properties;\n          const data = await api.getRouteGeoJSON([start, end], \"driving-car\");\n          if (!data || !data.features || data.features.length === 0) throw new Error(\"No route\");\n          const feat = data.features[0];\n          setRoute(feat);\n          setEtaInfo(((_feat$properties = feat.properties) === null || _feat$properties === void 0 ? void 0 : _feat$properties.summary) || null);\n          setLoadingRoute(false);\n          return;\n        } catch (err) {\n          console.warn(\"Backend ORS proxy failed:\", err);\n        }\n      }\n      if (process.env.REACT_APP_ORS_KEY) {\n        try {\n          var _data$features, _feat$properties2;\n          const resp = await fetch(\"https://api.openrouteservice.org/v2/directions/driving-car/geojson\", {\n            method: \"POST\",\n            headers: {\n              Authorization: process.env.REACT_APP_ORS_KEY,\n              \"Content-Type\": \"application/json\"\n            },\n            body: JSON.stringify({\n              coordinates: [start, end]\n            })\n          });\n          if (!resp.ok) throw new Error(`ORS HTTP ${resp.status}`);\n          const data = await resp.json();\n          const feat = (_data$features = data.features) === null || _data$features === void 0 ? void 0 : _data$features[0];\n          setRoute(feat);\n          setEtaInfo(((_feat$properties2 = feat.properties) === null || _feat$properties2 === void 0 ? void 0 : _feat$properties2.summary) || null);\n          setLoadingRoute(false);\n          return;\n        } catch (e) {\n          console.error(\"Direct ORS call failed:\", e);\n        }\n      }\n\n      // fallback: haversine estimate\n      const haversine = (a, b) => {\n        const R = 6371;\n        const toRad = x => x * Math.PI / 180;\n        const dLat = toRad(b[1] - a[1]);\n        const dLon = toRad(b[0] - a[0]);\n        const lat1 = toRad(a[1]);\n        const lat2 = toRad(b[1]);\n        const sinDLat = Math.sin(dLat / 2);\n        const sinDLon = Math.sin(dLon / 2);\n        const c = 2 * Math.atan2(Math.sqrt(sinDLat * sinDLat + Math.cos(lat1) * Math.cos(lat2) * sinDLon * sinDLon), Math.sqrt(1 - (sinDLat * sinDLat + Math.cos(lat1) * Math.cos(lat2) * sinDLon * sinDLon)));\n        return R * c;\n      };\n      const distKm = haversine(start, end);\n      const avgSpeedKmh = 30;\n      const estMin = Math.round(distKm / avgSpeedKmh * 60);\n      setEtaInfo({\n        distance: Math.round(distKm * 1000),\n        duration: estMin * 60\n      });\n      setLoadingRoute(false);\n      alert(\"Precise route not available â€” showing straight-line ETA estimate.\");\n    }, err => {\n      alert(\"Allow location to calculate ETA\");\n    });\n  }\n\n  // comment posting, with authority highlighting\n  function handleCommentPost() {\n    if (!commentText.trim()) return;\n    const isAuthorityUser = (user === null || user === void 0 ? void 0 : user.role) === \"authority\";\n    const authorName = (user === null || user === void 0 ? void 0 : user.name) || (user === null || user === void 0 ? void 0 : user.username) || \"authority\";\n    const comment = {\n      author: isAuthorityUser ? `Authority (${authorName})` : (user === null || user === void 0 ? void 0 : user.name) || (user === null || user === void 0 ? void 0 : user.username) || \"anonymous\",\n      text: commentText.trim(),\n      at: new Date().toISOString(),\n      byAuthority: !!isAuthorityUser\n    };\n    if (process.env.REACT_APP_API_BASE) {\n      api.commentReport(report.id, comment).then(() => {\n        onComment(report.id, comment);\n      }).catch(() => {\n        onComment(report.id, comment);\n      });\n    } else {\n      const arr = JSON.parse(localStorage.getItem(\"seva_reports\") || \"[]\");\n      const updated = arr.map(r => r.id === report.id ? {\n        ...r,\n        comments: [...(r.comments || []), comment]\n      } : r);\n      localStorage.setItem(\"seva_reports\", JSON.stringify(updated));\n      onComment(report.id, comment);\n    }\n    setCommentText(\"\");\n  }\n  const googleNav = report.lat && report.lng ? `https://www.google.com/maps/dir/?api=1&destination=${report.lat},${report.lng}&travelmode=driving` : \"https://www.google.com/maps\";\n\n  // ðŸ”½ NEW: Download current report view as PDF (with map)\n  async function handleDownloadPdf() {\n    if (!pdfRef.current) return;\n    try {\n      const element = pdfRef.current;\n\n      // little scroll to top to avoid cut-off\n      window.scrollTo(0, 0);\n      const canvas = await html2canvas(element, {\n        scale: 2,\n        useCORS: true // try to load map tiles if CORS allows\n      });\n      const imgData = canvas.toDataURL(\"image/png\");\n      const pdf = new jsPDF(\"p\", \"mm\", \"a4\");\n      const pageWidth = pdf.internal.pageSize.getWidth();\n      const pageHeight = pdf.internal.pageSize.getHeight();\n      const imgWidthPx = canvas.width;\n      const imgHeightPx = canvas.height;\n      const ratio = Math.min(pageWidth / imgWidthPx, pageHeight / imgHeightPx);\n      const imgWidth = imgWidthPx * ratio;\n      const imgHeight = imgHeightPx * ratio;\n      const x = (pageWidth - imgWidth) / 2;\n      const y = 10;\n      pdf.addImage(imgData, \"PNG\", x, y, imgWidth, imgHeight);\n      pdf.save(`seva-report-${report.id || \"report\"}.pdf`);\n    } catch (err) {\n      console.error(\"PDF generation failed:\", err);\n      alert(\"Could not generate PDF. Please try again.\");\n    }\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"report-view card\",\n    style: {\n      position: \"relative\",\n      maxHeight: \"90vh\",\n      overflowY: \"auto\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"close\",\n      onClick: onClose,\n      children: \"X\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: \"absolute\",\n        right: 48,\n        top: 10\n      },\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn-outline\",\n        onClick: handleDownloadPdf,\n        children: \"Download PDF\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: pdfRef,\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        style: {\n          display: \"flex\",\n          alignItems: \"center\",\n          gap: 12\n        },\n        children: [report.title, report.assignedTo && /*#__PURE__*/_jsxDEV(\"small\", {\n          style: {\n            color: \"#666\"\n          },\n          children: [\"(\", report.assignedTo, \")\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 248,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: report.desc\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 252,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [/*#__PURE__*/_jsxDEV(\"b\", {\n          children: \"Area:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 11\n        }, this), \" \", report.area, \" | \", /*#__PURE__*/_jsxDEV(\"b\", {\n          children: \"Pincode:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 40\n        }, this), \" \", report.pincode]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 253,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [/*#__PURE__*/_jsxDEV(\"b\", {\n          children: \"Author:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 257,\n          columnNumber: 11\n        }, this), \" \", report.createdBy || \"anonymous\", \" |\", \" \", /*#__PURE__*/_jsxDEV(\"b\", {\n          children: \"Assigned to:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 11\n        }, this), \" \", assignedName || report.assignedTo || \"Not assigned\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: \"flex\",\n          gap: 8,\n          marginTop: 8\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn\",\n          onClick: calcETA,\n          disabled: loadingRoute,\n          children: loadingRoute ? \"Calculating...\" : \"Calculate ETA & Route\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 262,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n          className: \"btn-outline\",\n          href: googleNav,\n          target: \"_blank\",\n          rel: \"noreferrer\",\n          children: \"Open in Google Maps\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 261,\n        columnNumber: 9\n      }, this), etaInfo && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: 8\n        },\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(\"b\", {\n            children: \"Estimated travel:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 278,\n            columnNumber: 15\n          }, this), \" \", (etaInfo.distance / 1000).toFixed(2), \" km \\u2014\", \" \", (etaInfo.duration / 60).toFixed(0), \" min\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 277,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 276,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: 12\n        },\n        children: /*#__PURE__*/_jsxDEV(MapView, {\n          markers: [{\n            id: report.id,\n            lat: parseFloat(report.lat),\n            lng: parseFloat(report.lng),\n            title: report.title,\n            desc: report.desc,\n            author: report.createdBy,\n            assignedTo: report.assignedTo,\n            assignedName\n          }],\n          height: \"300px\",\n          route: route\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 286,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 285,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: 12\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          children: \"Comments\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 305,\n          columnNumber: 11\n        }, this), (_report$comments = report.comments) !== null && _report$comments !== void 0 && _report$comments.length ? report.comments.map((c, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"comment\",\n          style: {\n            borderLeft: c.byAuthority || c.adminReply ? \"3px solid #2ecc71\" : \"3px solid transparent\",\n            paddingLeft: 8,\n            marginBottom: 8\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: \"flex\",\n              alignItems: \"center\",\n              gap: 8\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"b\", {\n              children: c.author\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 323,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n              style: {\n                color: \"#666\"\n              },\n              children: new Date(c.at).toLocaleString()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 324,\n              columnNumber: 19\n            }, this), (c.byAuthority || c.adminReply) && /*#__PURE__*/_jsxDEV(VerifiedBadge, {\n              text: c.byAuthority ? \"Authority\" : \"Verified\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 328,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 320,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            style: {\n              marginTop: 6\n            },\n            children: c.text\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 333,\n            columnNumber: 17\n          }, this)]\n        }, c.id || c.at || idx, true, {\n          fileName: _jsxFileName,\n          lineNumber: 308,\n          columnNumber: 15\n        }, this)) : /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"No comments yet\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 337,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: \"flex\",\n            gap: 8,\n            marginTop: 8\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            placeholder: \"Write a comment...\",\n            value: commentText,\n            onChange: e => setCommentText(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 341,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn\",\n            onClick: handleCommentPost,\n            children: \"Post\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 346,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 340,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 304,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 244,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 228,\n    columnNumber: 5\n  }, this);\n}\n_s(ReportView, \"+R+Acepuzjqvnd3fJzOLDhfst8I=\");\n_c2 = ReportView;\nvar _c, _c2;\n$RefreshReg$(_c, \"VerifiedBadge\");\n$RefreshReg$(_c2, \"ReportView\");","map":{"version":3,"names":["React","useEffect","useState","useRef","MapView","api","jsPDF","html2canvas","jsxDEV","_jsxDEV","VerifiedBadge","text","style","display","alignItems","gap","background","color","padding","borderRadius","fontSize","marginLeft","children","fileName","_jsxFileName","lineNumber","columnNumber","fontWeight","_c","ReportView","report","onClose","onComment","user","_s","_report$comments","commentText","setCommentText","route","setRoute","etaInfo","setEtaInfo","loadingRoute","setLoadingRoute","assignedName","setAssignedName","assignedTo","pdfRef","fetchAssigned","process","env","REACT_APP_API_BASE","a","getAuthorityById","name","e","auths","JSON","parse","localStorage","getItem","found","find","x","id","calcETA","lat","lng","alert","navigator","geolocation","getCurrentPosition","pos","start","coords","longitude","latitude","end","parseFloat","_feat$properties","data","getRouteGeoJSON","features","length","Error","feat","properties","summary","err","console","warn","REACT_APP_ORS_KEY","_data$features","_feat$properties2","resp","fetch","method","headers","Authorization","body","stringify","coordinates","ok","status","json","error","haversine","b","R","toRad","Math","PI","dLat","dLon","lat1","lat2","sinDLat","sin","sinDLon","c","atan2","sqrt","cos","distKm","avgSpeedKmh","estMin","round","distance","duration","handleCommentPost","trim","isAuthorityUser","role","authorName","username","comment","author","at","Date","toISOString","byAuthority","commentReport","then","catch","arr","updated","map","r","comments","setItem","googleNav","handleDownloadPdf","current","element","window","scrollTo","canvas","scale","useCORS","imgData","toDataURL","pdf","pageWidth","internal","pageSize","getWidth","pageHeight","getHeight","imgWidthPx","width","imgHeightPx","height","ratio","min","imgWidth","imgHeight","y","addImage","save","className","position","maxHeight","overflowY","onClick","right","top","ref","title","desc","area","pincode","createdBy","marginTop","disabled","href","target","rel","toFixed","markers","idx","borderLeft","adminReply","paddingLeft","marginBottom","toLocaleString","placeholder","value","onChange","_c2","$RefreshReg$"],"sources":["/Users/devanshgoenka/Desktop/seva/frontend/src/components/ReportView.jsx"],"sourcesContent":["// src/components/ReportView.jsx\nimport React, { useEffect, useState, useRef } from \"react\";\nimport MapView from \"./MapView\";\nimport api from \"../api/api\";\nimport { jsPDF } from \"jspdf\";\nimport html2canvas from \"html2canvas\";\n\nfunction VerifiedBadge({ text }) {\n  return (\n    <span\n      style={{\n        display: \"inline-flex\",\n        alignItems: \"center\",\n        gap: 6,\n        background: \"#e6ffed\",\n        color: \"#0b7a3a\",\n        padding: \"2px 8px\",\n        borderRadius: 12,\n        fontSize: 12,\n        marginLeft: 8,\n      }}\n    >\n      <strong>âœ“</strong>\n      <span style={{ fontWeight: 600 }}>{text || \"Verified\"}</span>\n    </span>\n  );\n}\n\nexport default function ReportView({ report, onClose, onComment, user }) {\n  const [commentText, setCommentText] = useState(\"\");\n  const [route, setRoute] = useState(null);\n  const [etaInfo, setEtaInfo] = useState(null);\n  const [loadingRoute, setLoadingRoute] = useState(false);\n  const [assignedName, setAssignedName] = useState(report.assignedTo || null);\n\n  // ðŸ”½ NEW: ref for PDF capture\n  const pdfRef = useRef(null);\n\n  useEffect(() => {\n    async function fetchAssigned() {\n      if (!report.assignedTo) return;\n      if (process.env.REACT_APP_API_BASE) {\n        try {\n          const a = await api.getAuthorityById(report.assignedTo);\n          if (a && a.name) setAssignedName(a.name);\n          return;\n        } catch (e) {}\n      }\n      const auths = JSON.parse(localStorage.getItem(\"seva_authorities\") || \"[]\");\n      const found = auths.find((x) => x.id === report.assignedTo);\n      if (found) setAssignedName(found.name);\n    }\n    fetchAssigned();\n  }, [report.assignedTo]);\n\n  async function calcETA() {\n    if (!report.lat || !report.lng) {\n      alert(\"Report has no coordinates\");\n      return;\n    }\n    if (!navigator.geolocation) {\n      alert(\"Geolocation not available\");\n      return;\n    }\n\n    navigator.geolocation.getCurrentPosition(\n      async (pos) => {\n        setLoadingRoute(true);\n        const start = [pos.coords.longitude, pos.coords.latitude];\n        const end = [parseFloat(report.lng), parseFloat(report.lat)];\n\n        if (process.env.REACT_APP_API_BASE) {\n          try {\n            const data = await api.getRouteGeoJSON([start, end], \"driving-car\");\n            if (!data || !data.features || data.features.length === 0)\n              throw new Error(\"No route\");\n            const feat = data.features[0];\n            setRoute(feat);\n            setEtaInfo(feat.properties?.summary || null);\n            setLoadingRoute(false);\n            return;\n          } catch (err) {\n            console.warn(\"Backend ORS proxy failed:\", err);\n          }\n        }\n\n        if (process.env.REACT_APP_ORS_KEY) {\n          try {\n            const resp = await fetch(\n              \"https://api.openrouteservice.org/v2/directions/driving-car/geojson\",\n              {\n                method: \"POST\",\n                headers: {\n                  Authorization: process.env.REACT_APP_ORS_KEY,\n                  \"Content-Type\": \"application/json\",\n                },\n                body: JSON.stringify({ coordinates: [start, end] }),\n              }\n            );\n            if (!resp.ok) throw new Error(`ORS HTTP ${resp.status}`);\n            const data = await resp.json();\n            const feat = data.features?.[0];\n            setRoute(feat);\n            setEtaInfo(feat.properties?.summary || null);\n            setLoadingRoute(false);\n            return;\n          } catch (e) {\n            console.error(\"Direct ORS call failed:\", e);\n          }\n        }\n\n        // fallback: haversine estimate\n        const haversine = (a, b) => {\n          const R = 6371;\n          const toRad = (x) => (x * Math.PI) / 180;\n          const dLat = toRad(b[1] - a[1]);\n          const dLon = toRad(b[0] - a[0]);\n          const lat1 = toRad(a[1]);\n          const lat2 = toRad(b[1]);\n          const sinDLat = Math.sin(dLat / 2);\n          const sinDLon = Math.sin(dLon / 2);\n          const c =\n            2 *\n            Math.atan2(\n              Math.sqrt(\n                sinDLat * sinDLat +\n                  Math.cos(lat1) * Math.cos(lat2) * sinDLon * sinDLon\n              ),\n              Math.sqrt(\n                1 -\n                  (sinDLat * sinDLat +\n                    Math.cos(lat1) * Math.cos(lat2) * sinDLon * sinDLon)\n              )\n            );\n          return R * c;\n        };\n        const distKm = haversine(start, end);\n        const avgSpeedKmh = 30;\n        const estMin = Math.round((distKm / avgSpeedKmh) * 60);\n        setEtaInfo({ distance: Math.round(distKm * 1000), duration: estMin * 60 });\n        setLoadingRoute(false);\n        alert(\"Precise route not available â€” showing straight-line ETA estimate.\");\n      },\n      (err) => {\n        alert(\"Allow location to calculate ETA\");\n      }\n    );\n  }\n\n  // comment posting, with authority highlighting\n  function handleCommentPost() {\n    if (!commentText.trim()) return;\n    const isAuthorityUser = user?.role === \"authority\";\n    const authorName = user?.name || user?.username || \"authority\";\n    const comment = {\n      author: isAuthorityUser\n        ? `Authority (${authorName})`\n        : user?.name || user?.username || \"anonymous\",\n      text: commentText.trim(),\n      at: new Date().toISOString(),\n      byAuthority: !!isAuthorityUser,\n    };\n\n    if (process.env.REACT_APP_API_BASE) {\n      api\n        .commentReport(report.id, comment)\n        .then(() => {\n          onComment(report.id, comment);\n        })\n        .catch(() => {\n          onComment(report.id, comment);\n        });\n    } else {\n      const arr = JSON.parse(localStorage.getItem(\"seva_reports\") || \"[]\");\n      const updated = arr.map((r) =>\n        r.id === report.id\n          ? { ...r, comments: [...(r.comments || []), comment] }\n          : r\n      );\n      localStorage.setItem(\"seva_reports\", JSON.stringify(updated));\n      onComment(report.id, comment);\n    }\n    setCommentText(\"\");\n  }\n\n  const googleNav =\n    report.lat && report.lng\n      ? `https://www.google.com/maps/dir/?api=1&destination=${report.lat},${report.lng}&travelmode=driving`\n      : \"https://www.google.com/maps\";\n\n  // ðŸ”½ NEW: Download current report view as PDF (with map)\n  async function handleDownloadPdf() {\n    if (!pdfRef.current) return;\n    try {\n      const element = pdfRef.current;\n\n      // little scroll to top to avoid cut-off\n      window.scrollTo(0, 0);\n\n      const canvas = await html2canvas(element, {\n        scale: 2,\n        useCORS: true, // try to load map tiles if CORS allows\n      });\n\n      const imgData = canvas.toDataURL(\"image/png\");\n      const pdf = new jsPDF(\"p\", \"mm\", \"a4\");\n      const pageWidth = pdf.internal.pageSize.getWidth();\n      const pageHeight = pdf.internal.pageSize.getHeight();\n\n      const imgWidthPx = canvas.width;\n      const imgHeightPx = canvas.height;\n      const ratio = Math.min(pageWidth / imgWidthPx, pageHeight / imgHeightPx);\n\n      const imgWidth = imgWidthPx * ratio;\n      const imgHeight = imgHeightPx * ratio;\n      const x = (pageWidth - imgWidth) / 2;\n      const y = 10;\n\n      pdf.addImage(imgData, \"PNG\", x, y, imgWidth, imgHeight);\n      pdf.save(`seva-report-${report.id || \"report\"}.pdf`);\n    } catch (err) {\n      console.error(\"PDF generation failed:\", err);\n      alert(\"Could not generate PDF. Please try again.\");\n    }\n  }\n\n  return (\n    <div\n      className=\"report-view card\"\n      style={{ position: \"relative\", maxHeight: \"90vh\", overflowY: \"auto\" }}\n    >\n      <button className=\"close\" onClick={onClose}>\n        X\n      </button>\n\n      {/* ðŸ”½ New Download PDF button */}\n      <div style={{ position: \"absolute\", right: 48, top: 10 }}>\n        <button className=\"btn-outline\" onClick={handleDownloadPdf}>\n          Download PDF\n        </button>\n      </div>\n\n      {/* Everything we want inside PDF is under this ref */}\n      <div ref={pdfRef}>\n        <h3 style={{ display: \"flex\", alignItems: \"center\", gap: 12 }}>\n          {report.title}\n          {report.assignedTo && (\n            <small style={{ color: \"#666\" }}>({report.assignedTo})</small>\n          )}\n        </h3>\n\n        <p>{report.desc}</p>\n        <p>\n          <b>Area:</b> {report.area} | <b>Pincode:</b> {report.pincode}\n        </p>\n        <p>\n          <b>Author:</b> {report.createdBy || \"anonymous\"} |{\" \"}\n          <b>Assigned to:</b> {assignedName || report.assignedTo || \"Not assigned\"}\n        </p>\n\n        <div style={{ display: \"flex\", gap: 8, marginTop: 8 }}>\n          <button className=\"btn\" onClick={calcETA} disabled={loadingRoute}>\n            {loadingRoute ? \"Calculating...\" : \"Calculate ETA & Route\"}\n          </button>\n          <a\n            className=\"btn-outline\"\n            href={googleNav}\n            target=\"_blank\"\n            rel=\"noreferrer\"\n          >\n            Open in Google Maps\n          </a>\n        </div>\n\n        {etaInfo && (\n          <div style={{ marginTop: 8 }}>\n            <p>\n              <b>Estimated travel:</b>{\" \"}\n              {(etaInfo.distance / 1000).toFixed(2)} km â€”{\" \"}\n              {(etaInfo.duration / 60).toFixed(0)} min\n            </p>\n          </div>\n        )}\n\n        <div style={{ marginTop: 12 }}>\n          <MapView\n            markers={[\n              {\n                id: report.id,\n                lat: parseFloat(report.lat),\n                lng: parseFloat(report.lng),\n                title: report.title,\n                desc: report.desc,\n                author: report.createdBy,\n                assignedTo: report.assignedTo,\n                assignedName,\n              },\n            ]}\n            height=\"300px\"\n            route={route}\n          />\n        </div>\n\n        <div style={{ marginTop: 12 }}>\n          <h4>Comments</h4>\n          {report.comments?.length ? (\n            report.comments.map((c, idx) => (\n              <div\n                key={c.id || c.at || idx}\n                className=\"comment\"\n                style={{\n                  borderLeft:\n                    c.byAuthority || c.adminReply\n                      ? \"3px solid #2ecc71\"\n                      : \"3px solid transparent\",\n                  paddingLeft: 8,\n                  marginBottom: 8,\n                }}\n              >\n                <div\n                  style={{ display: \"flex\", alignItems: \"center\", gap: 8 }}\n                >\n                  <b>{c.author}</b>\n                  <small style={{ color: \"#666\" }}>\n                    {new Date(c.at).toLocaleString()}\n                  </small>\n                  {(c.byAuthority || c.adminReply) && (\n                    <VerifiedBadge\n                      text={c.byAuthority ? \"Authority\" : \"Verified\"}\n                    />\n                  )}\n                </div>\n                <p style={{ marginTop: 6 }}>{c.text}</p>\n              </div>\n            ))\n          ) : (\n            <p>No comments yet</p>\n          )}\n\n          <div style={{ display: \"flex\", gap: 8, marginTop: 8 }}>\n            <input\n              placeholder=\"Write a comment...\"\n              value={commentText}\n              onChange={(e) => setCommentText(e.target.value)}\n            />\n            <button className=\"btn\" onClick={handleCommentPost}>\n              Post\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}